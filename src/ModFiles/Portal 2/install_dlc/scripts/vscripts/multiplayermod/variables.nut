//---------------------------------------------------
//         *****!Do not edit this file!*****
//---------------------------------------------------
//   ___  ___  _  __  __  __  __
//  | _ \|_  )(_)|  \/  ||  \/  |
//  |  _/ / /  _ | |\/| || |\/| |
//  |_|__/___|(_)|_|  |_||_|  |_|
//   / __| ___  __| | ___
//  | (__ / _ \/ _` |/ -_)
//  _\___|\___/\__,_|\___|     _     _           _
//  \ \ / /__ _  _ _ (_) __ _ | |__ | | ___  ___(_)
//   \ V // _` || '_|| |/ _` || '_ \| |/ -_)(_-< _
//    \_/ \__,_||_|  |_|\__,_||_.__/|_|\___|/__/(_)
//---------------------------------------------------
// Purpose: Here, we declare and set up almost
// every variable used throughout the P2:MM codebase.
//---------------------------------------------------

//---------------
// Classes
//---------------
class GlobalSpawnClass {
    useautospawn = false // Try To Make All Spawns Global
    usesetspawn = false // Use Set Spawnpoint

    // Set SpawnPoint
    setspawn = class {
        position = Vector(0,0,0)
        radius = 0
    }

    // Red's Default Spawn Parameters
    red = class {
        spawnpoint = Vector(0,0,0)
        rotation = Vector(0,0,0)
        velocity = Vector(0,0,0)
    }
    // Blue's Default Spawn Parameters
    blue = class {
        spawnpoint = Vector(0,0,0)
        rotation = Vector(0,0,0)
        velocity = Vector(0,0,0)
    }
}

/*if (Config_UseChatCommands) {
    class Vote {
        CurrentTime = null
        ActiveVote = null
        VotedYes = 0
        VotedNo = 0
        Arg2 = null

        bVoteInProgress = false
        bCurrentCCPlayerInitiatedVote = false
        iCurrentNumberOfPlayers = 0
        constructor(p) {
            for (local player; player = Entities.FindByClassname(player, "player");) {
                iCurrentNumberOfPlayers++
                if (FindPlayerClass(player).startedvote) {
                    bVoteInProgress = true
                    if (p == player) {
                        // This player initiated the vote and
                        // is invoking the command again
                        bCurrentCCPlayerInitiatedVote = true
                    }
                }
            }
        }

        function IsAdminLevelEnough(player) {
            if (GetAdminLevel(player) >= 6) {
                return true
            }
            return false
        }
        function SubmitVote(arg1, arg2) {
            FindPlayerClass(arg2).hasvoted = true
            if (arg1 == "yes") {
                VotedYes++
            } else {
                VotedNo++
            }
            Entities.FindByName(null, "VoteCounter").__KeyValueFromString("message", "Vote (Y/N/All): " + VotedYes + "/" + VotedNo + "/" + iCurrentNumberOfPlayers)
            SendChatMessage("Submitted vote for " + arg1 + ".", arg2)
        }
        function DoVote(arg1) {
            if (VotedYes > VotedNo || arg1 == "succeed") {
                // Add stuff for actually changing in game stuffs
                switch (ActiveVote) {
                case "changelevel": 
                case "kick":        
                case "hostgunonly": 
                }
            }

            // Vote forcefully failed or didn't have enough votes
            // Clean everything up
            CurrentTime = null
            ActiveVote = null
            VotedYes = 0
            VotedNo = 0
            Arg2 = null

            bVoteInProgress = false
            bCurrentCCPlayerInitiatedVote = false
            iCurrentNumberOfPlayers = 0

            ShouldDisplayVoteCounter = false

            for (local player; player = Entities.FindByClassname(player, "player");) {
                FindPlayerClass(player).startedvote = false // Forget who initiated the vote
                FindPlayerClass(player).hasvoted = false // Forget all those that had voted
            }
            Entities.FindByName(null, "VoteCounter").__KeyValueFromString("message", "Vote (Y/N/All): " + VotedYes + "/" + VotedNo + "/" + iCurrentNumberOfPlayers)
        }
        function BeginVote(arg1, arg2, arg3) {
            // Update the class info
            Arg2 = arg2
            Vote.SubmitVote("yes", arg3)
            CurrentTime = Time()
            FindPlayerClass(arg3).startedvote = true
            FindPlayerClass(arg3).hasvoted = true
            ActiveVote = arg1
            SendChatMessage("Started vote for " + arg1 + ".", arg3)

            // Update the text color and players
            local rgb = FindPlayerClass(arg3).color
            Entities.FindByName(null, "VoteCounter").__KeyValueFromString("color", rgb.r.tostring() + " " + rgb.g.tostring() + " " + rgb.b.tostring())
            Entities.FindByName(null, "VoteCounter").__KeyValueFromString("message", "Vote (Y/N/All): " + VotedYes + "/" + VotedNo + "/" + iCurrentNumberOfPlayers)

            ShouldDisplayVoteCounter = true
        }
    }
}*/

//---------------
// Booleans
//---------------
AllowColorIndicator <- true // By default unless specified in mapsupport
AllowNametags <- true // By default unless specified in mapsupport
CanCheckAngle <- false
CanHook <- false
CheatsOn <- false
CoordsAlternate <- false

DevModeConfig <- Config_DevMode

DoneCacheing <- false
DoneWaiting <- false
fogs <- false
GlobalOverridePluginGrabController <- true // By default unless specified in mapsupport
HasSpawned <- false

IsOnSingleplayerMaps <- false
if (GetMapName().len() >= 7 && GetMapName().slice(0, 7) != "mp_coop") {
    IsOnSingleplayerMaps = true
}

MadeSpawnClass <- false
OrangeCacheFailed <- false
Player2Joined <- false
PostMapSpawnDone <- false
PermaPotato <- false

// if (Config_UseChatCommands) {
//     ShouldDisplayVoteCounter <- false
// }

StartDevModeCheck <- false
usefogcontroller <- false

//---------------
// Ints/Floats
//---------------
amtoffsetclr <- 0
cacheoriginalplayerposition <- 0
EntityCap <- 2000
EntityCapLeeway <- 20
FailsafeEntityCap <- 2010
looptime <- 0.1 // Amount of time in seconds to call Loop() consecutively
PlayerID <- 0
PreviousNametagItter <- 0
PreviousTime1Sec <- 0
PreviousTime5Sec <- 0

if (Config_RandomPortalSize) {
    randomportalsize <- 34
    randomportalsizeh <- 34
}

TickSpeed <- 0.00
TotalRemovedEnts <- 0

//---------------
// Arrays/Tables
//---------------
ConsoleAscii <- [
"\n██████╗░░█████╗░██████╗░████████╗░█████╗░██╗░░░░░░░░░░██████╗░"
  "██╔══██╗██╔══██╗██╔══██╗╚══██╔══╝██╔══██╗██║░░░░░░░░░░╚════██╗"
  "██████╔╝██║░░██║██████╔╝░░░██║░░░███████║██║░░░░░░░░░░░░███╔═╝"
  "██╔═══╝░██║░░██║██╔══██╗░░░██║░░░██╔══██║██║░░░░░░░░░░██╔══╝░░"
  "██║░░░░░╚█████╔╝██║░░██║░░░██║░░░██║░░██║███████╗░░░░░███████╗"
  "╚═╝░░░░░░╚════╝░╚═╝░░╚═╝░░░╚═╝░░░╚═╝░░╚═╝╚══════╝░░░░░╚══════╝"
  ""
  "░░░░░░███╗░░░███╗██████╗░░░░░███╗░░░███╗░█████╗░██████╗░░░░░░░"
  "░░░░░░████╗░████║██╔══██╗░░░░████╗░████║██╔══██╗██╔══██╗░░░░░░"
  "░░░░░░██╔████╔██║██████╔╝░░░░██╔████╔██║██║░░██║██║░░██║░░░░░░"
  "░░░░░░██║╚██╔╝██║██╔═══╝░░░░░██║╚██╔╝██║██║░░██║██║░░██║░░░░░░"
  "░░░░░░██║░╚═╝░██║██║░░░░░░░░░██║░╚═╝░██║╚█████╔╝██████╔╝░░░░░░"
  "░░░░░░╚═╝░░░░░╚═╝╚═╝░░░░░░░░░╚═╝░░░░░╚═╝░╚════╝░╚═════╝░░░░░░░\n"
]
CurrentlyDead <- []
entityclasses <- []
EventList <- []
ExpendableEntities <- [
    "logic_auto",
    "logic_autosave",
    "env_viewpunch",
    "env_shake",
    "info_particle_system",
    "env_fog_controller",
    "env_fade",
    "func_areaportal",
    "env_soundscape",
    "ambient_generic",
    "prop_physics_paintable",
    "prop_physics",
    "prop_physics_override",
    "prop_physics_multiplayer",
    "prop_detail",
    "prop_dynamic_ornament",
    "prop_dynamic_override",
    "func_illusionary",
    "func_brush",
    "prop_weighted_cube",
    "func_detail",
]
InvalidRootMoveParents <- [
    "player",
    "prop_portal",
    "worldspawn",
    ""
]
if (GetMapName() == "mp_coop_credits") {
    MPMCoopCreditNames <- [ // Add names to coop credits map (Max per entry is 128)
        "### ",
        "### ",
        "### ",
        "### ",
        "###Portal 2: Multiplayer Mod ~ Credits",
        "### ",
        "###--------------------------",
        "###P2:MM Head Creators",
        "###--------------------------",
        "kyleraykbs | Team Lead + Script + Launcher",
        "Nanoman2525 | Mapping + Entity Work + Launcher + Script",
        "Vista | Reverse Engineering, Plugin Developer",
        "Bumpy | Script Theory",
        "Wolƒe Strider Shoσter | Singleplayer Support",
        "cabiste | Scripting + Mod Launcher + Code Refactor",
        "###--------------------------",
        "###P2:MM Team Members",
        "###--------------------------",
        "sear | Speedrun Mode Ideas",
        "Jeffrey | Previous Code Cleanup",
        "###--------------------------",
        "###P2:MM Contributers",
        "###--------------------------",
        "Dreadnox | Speedrun Mode Ideas",
        "Enator18 | Python Dev"
        "Blub/Vecc | Previous Code Commenting",
        "Darnias | Jumpstarter Code",
        "PieCreeper | Promotion of the mod",
        "###--------------------------",
        "###Special Thanks To:",
        "###--------------------------",
        "SuperSpeed",
        "Mystical Ace",
        "ANotSoSpookySkeleton",
        "Panter",
        "tnp|\\n|thewoodster75",
        "ThePineapple",
        "Areng",
        "SuperSpeed",
        "Brawler",
        "X man",
        "###--------------------------",
        "###Valve: Credits",
        "###--------------------------",
    ]
}

if (Config_UseChatCommands) {
    mpcoursenames <- [
        "mp_coop_start",
        "mp_coop_doors",
        "mp_coop_fling_3",
        "mp_coop_wall_intro",
        "mp_coop_tbeam_redirect",
        "mp_coop_paint_come_along",
        "mp_coop_separation_1",
    ]
    spchapternames <- [
        "sp_a1_intro1",
        "sp_a2_laser_intro",
        "sp_a2_sphere_peek",
        "sp_a2_column_blocker",
        "sp_a2_bts3",
        "sp_a3_00",
        "sp_a3_speed_ramp",
        "sp_a4_intro",
        "sp_a4_finale1"
    ]
    teams <- [
        "Singleplayer",
        "Spectator", // This is not used at all since respawning is broken
        "Red",
        "Blue"
    ]
    commandtable <- {}
    commandtable["help"] <- "List available commands or print a description of a specific one."
    commandtable["noclip"] <- "Toggles your noclip status."
    commandtable["kill"] <- "Kill yourself, others, or \"all\"."
    commandtable["changeteam"] <- "Changes your current team."
    commandtable["speed"] <- "Changes your player speed."
    commandtable["teleport"] <- "Teleports a specific player or \"all\" to you or another player."
    commandtable["rcon"] <- "Execute commands on the server console."
    commandtable["restartlevel"] <- "Reset the current map."
    commandtable["spchapter"] <- "Changes the level to the specified singleplayer chapter."
    commandtable["mpcourse"] <- "Changes the level to the specified cooperative course."
    commandtable["playercolor"] <- "Changes your player model's color through valid RGB values."
    commandtable["adminmodify"] <- "Prints the admin level of someone or assigns them a new level."
    commandtable["rocket"] <- "Send yourself, others, or \"all\" into the air for them to blow up."
    commandtable["slap"] <- "Slap yourself, others, or \"all\" dealing a tiny amount of damage and jolting."
}
playerclasses <- []
PrecachedProps <- []

//---------------
// Others
//---------------
LastCoordGetPlayer <- null
OriginalAngle <- null
OriginalPosMain <- null
setspot <- Vector(0, 0, 250) //Vector(5107, 3566, -250)

/*if (Config_UseChatCommands) {
    VoteCounter <- Entities.CreateByClassname("game_text")
    VoteCounter.__KeyValueFromString("targetname", "VoteCounter")
    VoteCounter.__KeyValueFromString("x", "0.005")
    VoteCounter.__KeyValueFromString("y", "0.9")
    VoteCounter.__KeyValueFromString("message", "Vote #: 0/0")
    VoteCounter.__KeyValueFromString("holdtime", "5")
    VoteCounter.__KeyValueFromString("fadeout", "2")
    VoteCounter.__KeyValueFromString("fadein", "2")
    VoteCounter.__KeyValueFromString("channel", "0")
    VoteCounter.__KeyValueFromString("spawnflags", "1")
    VoteCounter.__KeyValueFromString("color", "255 255 255")
}*/
